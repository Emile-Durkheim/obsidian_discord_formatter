/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => DiscordFormatter
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");

// src/types.ts
var EmptyMessageError = class extends Error {
  // Thrown when an <li> is empty of message content; empty <li>'s are common when 
  // copy-pasting discord messages. Meant to be caught by DiscordConversation.
  constructor(message) {
    super(message);
    Object.setPrototypeOf(this, EmptyMessageError.prototype);
  }
};
var CouldNotParseError = class extends Error {
  // Thrown in DiscordMessage or DiscordConversation when unexpected HTML is encountenred
  constructor(message) {
    super(message);
    Object.setPrototypeOf(this, CouldNotParseError.prototype);
  }
};

// src/DiscordMessageReply.ts
var DiscordMessageReply = class {
  constructor(replyDiv) {
    var _a, _b;
    if (!/^message-reply-context/.test(replyDiv.id)) {
      console.error(replyDiv);
      throw new CouldNotParseError(`Expected <div id="message-reply-context...">`);
    }
    const nickname = (_a = replyDiv.querySelector("[class^='username-']")) == null ? void 0 : _a.textContent;
    if (!nickname) {
      console.error(replyDiv);
      throw new CouldNotParseError(`Expected a <span class='username-'> in div, but querySelector couldn't locate one`);
    }
    this.header = { nickname };
    const messageContentDiv = replyDiv.querySelector("[id^='message-content'");
    if (!messageContentDiv) {
      console.error(replyDiv);
      throw new CouldNotParseError(`Expectected a <span id='message-content-...'> in div, but querySelector couldn't locate one`);
    }
    const regexMessageId = /message-content-(\d{19})/.exec(messageContentDiv.id);
    if (regexMessageId && regexMessageId.length == 2) {
      this.context = { messageId: regexMessageId[1] };
    } else {
      console.error(replyDiv);
      throw new CouldNotParseError(`Could not find messageId`);
    }
    const messageContentElems = (_b = replyDiv.querySelector("div[id^='message-content']")) == null ? void 0 : _b.children;
    if (!messageContentElems) {
      console.error(replyDiv);
      throw new EmptyMessageError(`Message contains no text content`);
    }
    this.content = { text: DiscordMessage.parseMessageText(messageContentElems) };
  }
  toMarkdown() {
    return `>**${this.header.nickname}**: ${this.content.text}`;
  }
};

// src/DiscordMessage.ts
var DiscordMessage = class {
  constructor(MESSAGE_LI) {
    var _a;
    if (!((_a = MESSAGE_LI.firstElementChild) == null ? void 0 : _a.innerHTML)) {
      throw new EmptyMessageError("<li> seems to be empty");
    }
    try {
      this.constructMessageHeader(MESSAGE_LI);
    } catch (error) {
      if (!(error instanceof CouldNotParseError)) {
        throw error;
      }
    }
    this.constructMessageContext(MESSAGE_LI);
    this.constructMessageContent(MESSAGE_LI);
  }
  constructMessageHeader(MESSAGE_LI) {
    var _a, _b, _c;
    const headerDiv = MESSAGE_LI.querySelector("h3[class^='header']");
    if (!headerDiv) {
      throw new CouldNotParseError(`No <h3 class='header...'> found`);
    }
    const nickname = (_a = headerDiv.querySelector("span[class^='username']")) == null ? void 0 : _a.textContent;
    if (!nickname) {
      throw new CouldNotParseError(`Message Header exists, but could not find nickname`);
    }
    const timeExact = (_b = headerDiv.querySelector("time")) == null ? void 0 : _b.dateTime;
    let timeRelative = (_c = headerDiv.querySelector("time")) == null ? void 0 : _c.textContent;
    if (!(timeExact && timeRelative)) {
      throw new CouldNotParseError(`Message Header exists, but could not find time`);
    } else {
      const regexTimeRelative = /â€” (.*)/.exec(timeRelative);
      if (!(regexTimeRelative && regexTimeRelative.length == 2)) {
        throw new CouldNotParseError("Relative time could not be parsed from Regex");
      }
      timeRelative = regexTimeRelative[1];
    }
    const avatarDiv = MESSAGE_LI.querySelector("img[class^='avatar']");
    let avatarUrl = void 0;
    if (avatarDiv) {
      avatarUrl = avatarDiv.src;
    }
    const messageReplyDiv = MESSAGE_LI.querySelector("div[id^='message-reply'");
    let messageReply = void 0;
    if (messageReplyDiv) {
      messageReply = new DiscordMessageReply(messageReplyDiv);
    }
    const header = {
      nickname,
      timeExact: Date.parse(timeExact),
      timeRelative
    };
    if (avatarUrl)
      header.avatar = avatarUrl;
    if (messageReply)
      header.reply = messageReply;
    this.header = header;
  }
  constructMessageContent(MESSAGE_LI) {
    const messageTextElems = this.getMessageTextElems(MESSAGE_LI);
    const messageAttachmentElem = MESSAGE_LI.querySelector("div[id^='message-accessories']");
    if (!messageTextElems && !messageAttachmentElem) {
      throw new EmptyMessageError(`Message contains neither text content nor attachments`);
    }
    this.content = {};
    if (messageTextElems) {
      this.content.text = DiscordMessage.parseMessageText(messageTextElems);
    }
    if (messageAttachmentElem) {
      this.content.attachments = this.parseMessageAttachments(messageAttachmentElem);
    }
  }
  getMessageTextElems(MESSAGE_LI) {
    var _a;
    return (_a = MESSAGE_LI.querySelector("div[class^='contents'] > div[id^='message-content']")) == null ? void 0 : _a.children;
  }
  static parseMessageText(messageContentElems) {
    const message = [];
    for (const elem of Array.from(messageContentElems)) {
      let textContent = elem.textContent;
      if (!textContent) {
        if (/^emojiContainer/.test(elem.className)) {
          const imgElem = elem.children[0];
          if (!imgElem) {
            console.error("No img element found in span.emojiContainer");
          }
          if (/^:.+:$/.test(imgElem.alt)) {
            message.push(`<img src='${imgElem.src}' style='height: var(--font-text-size)'>`);
          } else {
            message.push(`${imgElem.alt}`);
          }
        }
        continue;
      }
      textContent = textContent.replace("\n", "\n>");
      switch (elem.nodeName) {
        case "EM": {
          message.push(`*${textContent}*`);
          break;
        }
        case "STRONG": {
          message.push(`**${textContent}**`);
          break;
        }
        case "U": {
          message.push(`<u>${textContent}</u>`);
          break;
        }
        case "S": {
          message.push(`~~${textContent}~~`);
          break;
        }
        case "H1": {
          message.push(`**${textContent}**
>`);
          break;
        }
        case "H2": {
          message.push(`**${textContent}**
>`);
          break;
        }
        case "H3": {
          message.push(`**${textContent}**
>`);
          break;
        }
        default: {
          if (/^blockquote/.test(elem.className)) {
            message.push(`>${textContent}`);
          } else if (/^timestamp/.test(elem.className)) {
            message.push(` *(edited)*`);
          } else {
            message.push(textContent);
          }
        }
      }
    }
    return message.join("");
  }
  parseMessageAttachments(messageAccessoryElem) {
    const messageAccessoryImages = Array.from(messageAccessoryElem.querySelectorAll("img"));
    return messageAccessoryImages.map((img) => {
      return img.src;
    });
  }
  constructMessageContext(MESSAGE_LI) {
    const IdRegex = /(\d{18})-(\d{19})/.exec(MESSAGE_LI.id);
    if (!(IdRegex && IdRegex.length == 3)) {
      console.log(MESSAGE_LI);
      throw new CouldNotParseError("messageId and serverId not found in <li> id");
    }
    this.context = {
      channelId: IdRegex[1],
      messageId: IdRegex[2]
    };
  }
  toMarkdown() {
    const markdownArray = [];
    if (this.header) {
      const date = new Date(this.header.timeExact);
      markdownArray.push(
        `**${this.header.nickname} - ${date.toLocaleString()}**`
      );
      if (this.header.reply) {
        markdownArray.push(this.header.reply.toMarkdown());
      }
    }
    if (this.content.text) {
      markdownArray.push(this.content.text);
    }
    if (this.content.attachments) {
      for (const url of this.content.attachments) {
        markdownArray.push(`![](${url})`);
      }
    }
    return ">" + markdownArray.join("\n>");
  }
};

// src/DiscordSingleMessage.ts
var DiscordSingleMessage = class extends DiscordMessage {
  constructor(messageDiv) {
    super(messageDiv);
  }
  getMessageTextElems(messageDiv) {
    var _a;
    return (_a = messageDiv.querySelector("div[id^='message-content']")) == null ? void 0 : _a.children;
  }
  constructMessageContext(messageDiv) {
    const messageContentElem = messageDiv.querySelector("div[id^='message-content']");
    const messageAccessoryElem = messageDiv.querySelector("div[id^='message-accessories']");
    if (!messageContentElem && !messageAccessoryElem) {
      throw new CouldNotParseError("No div#message-content nor div#message-accessories could be found.");
    }
    const channelIdRegex = /\d{18}/;
    let regexResult = void 0;
    if (messageContentElem) {
      regexResult = channelIdRegex.exec(messageContentElem.id);
    } else if (messageAccessoryElem) {
      regexResult = channelIdRegex.exec(messageAccessoryElem.id);
    }
    if (!(regexResult && regexResult.length == 1)) {
      throw new CouldNotParseError("Could not parse channel id from message-content div");
    }
    this.context = {
      channelId: regexResult[0]
    };
  }
};

// src/DiscordConversation.ts
var DiscordConversation = class {
  constructor(DOM) {
    if (!this.isDiscordPaste(DOM)) {
      throw new CouldNotParseError("Paste doesn't appear to be from Discord");
    }
    this.messages = this.createMessages(DOM);
  }
  static fromRawHTML(HTML) {
    const parser = new DOMParser();
    const DOM = parser.parseFromString(HTML, "text/html");
    return new this(DOM);
  }
  createMessages(DOM) {
    const discordMessages = [];
    const domOfMessages = Array.from(DOM.querySelectorAll("li"));
    if (domOfMessages.length > 0) {
      for (const message of domOfMessages) {
        try {
          discordMessages.push(new DiscordMessage(message));
        } catch (err) {
          if (!(err instanceof EmptyMessageError)) {
            throw err;
          } else {
            continue;
          }
        }
      }
    } else {
      discordMessages.push(new DiscordSingleMessage(DOM.body));
    }
    return discordMessages;
  }
  isDiscordPaste(DOM) {
    const messageContentElem = DOM.querySelector("div[id^='message-content']");
    if (messageContentElem) {
      if (!/message-content-\d{19}/.test(messageContentElem.id)) {
        console.error("isDiscordPaste FAIL: No <div id='message-content-\\d{19}'");
        return false;
      }
      if (!/markup-[\w\d]{6}/.test(messageContentElem.className)) {
        console.error("isDiscordPaste FAIL: No <div class='markup-\\w{6}'");
        return false;
      }
      if (!/messageContent-[\w\d]{6}/.test(messageContentElem.className)) {
        console.error("isDiscordPaste FAIL: No <div class='messageContent-\\w{6}'");
        return false;
      }
      return true;
    }
    const messageAccesoriesElem = DOM.querySelector("div[id^='message-accessories']");
    if (messageAccesoriesElem) {
      if (!/message-accessories-\d{19}/.test(messageAccesoriesElem.id)) {
        console.error("isDiscordPaste FAIL: No <div id='message-accessories-\\d{19}'");
        return false;
      }
      if (!/container-[\w\d]{6}/.test(messageAccesoriesElem.className)) {
        console.error("isDiscordPaste FAIL: No <div class='container-\\w{6}'");
        return false;
      }
      return true;
    }
    return false;
  }
  toMarkdown() {
    const markdownArray = [];
    for (const message of this.messages) {
      if (message.header && markdownArray.length > 0) {
        markdownArray.push(">");
      }
      markdownArray.push(message.toMarkdown());
    }
    return markdownArray.join("\n");
  }
};

// src/main.ts
var DEFAULT_SETTINGS = {};
var DiscordFormatter = class extends import_obsidian.Plugin {
  async onload() {
    await this.loadSettings();
    this.pasteMessageHandler = this.pasteMessage.bind(this);
    this.app.workspace.on("editor-paste", this.pasteMessageHandler);
  }
  onunload() {
    this.app.workspace.off("editor-paste", this.pasteMessageHandler);
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    this.saveData(this.settings);
  }
  pasteMessage(event) {
    var _a;
    const rawHTML = (_a = event.clipboardData) == null ? void 0 : _a.getData("text/html");
    const view = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (!(rawHTML && (view == null ? void 0 : view.editor))) {
      return;
    }
    const conversation = DiscordConversation.fromRawHTML(rawHTML);
    if (conversation.messages.length == 0) {
      return;
    }
    event.preventDefault();
    view.editor.replaceSelection(conversation.toMarkdown());
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9EaXNjb3JkTWVzc2FnZVJlcGx5LnRzIiwgInNyYy9EaXNjb3JkTWVzc2FnZS50cyIsICJzcmMvRGlzY29yZFNpbmdsZU1lc3NhZ2UudHMiLCAic3JjL0Rpc2NvcmRDb252ZXJzYXRpb24udHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IE1hcmtkb3duVmlldywgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5pbXBvcnQgRGlzY29yZENvbnZlcnNhdGlvbiBmcm9tICdzcmMvRGlzY29yZENvbnZlcnNhdGlvbic7XG5cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1lbXB0eS1pbnRlcmZhY2VcbmludGVyZmFjZSBEaXNjb3JkRm9ybWF0dGVyU2V0dGluZ3Mge31cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogRGlzY29yZEZvcm1hdHRlclNldHRpbmdzID0ge31cblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEaXNjb3JkRm9ybWF0dGVyIGV4dGVuZHMgUGx1Z2luIHtcblx0c2V0dGluZ3M6IERpc2NvcmRGb3JtYXR0ZXJTZXR0aW5nc1xuXHRwYXN0ZU1lc3NhZ2VIYW5kbGVyOiAoZXZlbnQ6IENsaXBib2FyZEV2ZW50KSA9PiB2b2lkO1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXHRcdFxuXHRcdC8vIERlZmluZSBiZWhhdmlvdXIgb24gcGFzdGVcblx0XHR0aGlzLnBhc3RlTWVzc2FnZUhhbmRsZXIgPSB0aGlzLnBhc3RlTWVzc2FnZS5iaW5kKHRoaXMpO1xuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLXBhc3RlJywgdGhpcy5wYXN0ZU1lc3NhZ2VIYW5kbGVyKVxuXHR9XG5cblxuXHRvbnVubG9hZCgpIHtcblx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub2ZmKCdlZGl0b3ItcGFzdGUnLCB0aGlzLnBhc3RlTWVzc2FnZUhhbmRsZXIpXG5cdH1cblxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblxuXHRwYXN0ZU1lc3NhZ2UoZXZlbnQ6IENsaXBib2FyZEV2ZW50KXtcblx0XHRjb25zdCByYXdIVE1MID0gZXZlbnQuY2xpcGJvYXJkRGF0YT8uZ2V0RGF0YSgndGV4dC9odG1sJyk7XG5cdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cblx0XHRpZighKHJhd0hUTUwgJiYgdmlldz8uZWRpdG9yKSl7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IGNvbnZlcnNhdGlvbiA9IERpc2NvcmRDb252ZXJzYXRpb24uZnJvbVJhd0hUTUwocmF3SFRNTCk7XG5cdFx0aWYoY29udmVyc2F0aW9uLm1lc3NhZ2VzLmxlbmd0aCA9PSAwKXtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZpZXcuZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oY29udmVyc2F0aW9uLnRvTWFya2Rvd24oKSk7XG5cdH1cbn1cblxuIiwgImltcG9ydCBEaXNjb3JkTWVzc2FnZVJlcGx5IGZyb20gXCIuL0Rpc2NvcmRNZXNzYWdlUmVwbHlcIjtcblxuZXhwb3J0IGNsYXNzIEVtcHR5TWVzc2FnZUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIC8vIFRocm93biB3aGVuIGFuIDxsaT4gaXMgZW1wdHkgb2YgbWVzc2FnZSBjb250ZW50OyBlbXB0eSA8bGk+J3MgYXJlIGNvbW1vbiB3aGVuIFxuICAgIC8vIGNvcHktcGFzdGluZyBkaXNjb3JkIG1lc3NhZ2VzLiBNZWFudCB0byBiZSBjYXVnaHQgYnkgRGlzY29yZENvbnZlcnNhdGlvbi5cblxuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2U/OiBzdHJpbmcpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XG5cbiAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIEVtcHR5TWVzc2FnZUVycm9yLnByb3RvdHlwZSk7XG4gICAgfVxufVxuXG5cbmV4cG9ydCBjbGFzcyBDb3VsZE5vdFBhcnNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gICAgLy8gVGhyb3duIGluIERpc2NvcmRNZXNzYWdlIG9yIERpc2NvcmRDb252ZXJzYXRpb24gd2hlbiB1bmV4cGVjdGVkIEhUTUwgaXMgZW5jb3VudGVucmVkXG4gICAgY29uc3RydWN0b3IobWVzc2FnZT86IHN0cmluZykge1xuICAgICAgICBzdXBlcihtZXNzYWdlKTtcblxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgQ291bGROb3RQYXJzZUVycm9yLnByb3RvdHlwZSk7XG4gICAgfVxufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgSURpc2NvcmRNZXNzYWdlIHtcbiAgICB0b01hcmtkb3duKCk6IHN0cmluZ1xuXG4gICAgY29udGVudDoge1xuICAgICAgICB0ZXh0Pzogc3RyaW5nLFxuICAgICAgICBhdHRhY2htZW50cz86IHN0cmluZ1tdICAvLyBjb250YWlucyBVUkwgdG8gYXR0YWNobWVudChzKVxuICAgIH1cbiAgICBcbiAgICBjb250ZXh0OiB7XG4gICAgICAgIGNoYW5uZWxJZDogc3RyaW5nXG4gICAgICAgIG1lc3NhZ2VJZD86IHN0cmluZywgIC8vIG1lc3NhZ2VkIElEIHdpbGwgYmUgdW5rbm93biB3aGVuIHBhc3RlIGhhcHBlbnMgdG8gYmUgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluIERpc2NvcmRTaW5nbGVNZXNzYWdlIGZvcm1hdFxuICAgIH07XG5cbiAgICBoZWFkZXI/OiB7XG4gICAgICAgIG5pY2tuYW1lOiBzdHJpbmcsXG4gICAgICAgIHRpbWVFeGFjdD86IG51bWJlciwgIC8vIHVuaXggdGltZXN0YW1wIGluIG1pbGxpc2Vjb25kc1xuICAgICAgICB0aW1lUmVsYXRpdmU/OiBzdHJpbmcsXG4gICAgICAgIGF2YXRhcj86IHN0cmluZywgIC8vIHVybFxuICAgICAgICByZXBseT86IERpc2NvcmRNZXNzYWdlUmVwbHlcbiAgICB9XG59IiwgImltcG9ydCBEaXNjb3JkTWVzc2FnZSBmcm9tIFwiLi9EaXNjb3JkTWVzc2FnZVwiXG5pbXBvcnQgeyBDb3VsZE5vdFBhcnNlRXJyb3IsIEVtcHR5TWVzc2FnZUVycm9yIH0gZnJvbSBcIi4vdHlwZXNcIlxuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERpc2NvcmRNZXNzYWdlUmVwbHkge1xuICAgIGNvbnRleHQ6IHtcbiAgICAgICAgbWVzc2FnZUlkOiBzdHJpbmdcbiAgICB9XG4gICAgY29udGVudDoge1xuICAgICAgICB0ZXh0OiBzdHJpbmdcbiAgICB9XG4gICAgaGVhZGVyOiB7XG4gICAgICAgIG5pY2tuYW1lOiBzdHJpbmdcbiAgICB9XG5cbiAgICBjb25zdHJ1Y3RvcihyZXBseURpdjogRWxlbWVudCl7XG4gICAgICAgIC8vIENoZWNrIGlmIGEgcmVwbHlEaXYgd2FzIGFjdHVhbGx5IHBhc3NlZCBpblxuICAgICAgICBpZighL15tZXNzYWdlLXJlcGx5LWNvbnRleHQvLnRlc3QocmVwbHlEaXYuaWQpKXtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocmVwbHlEaXYpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IENvdWxkTm90UGFyc2VFcnJvcihgRXhwZWN0ZWQgPGRpdiBpZD1cIm1lc3NhZ2UtcmVwbHktY29udGV4dC4uLlwiPmApO1xuICAgICAgICB9XG5cblxuICAgICAgICAvLyBQYXJzZSBuaWNrbmFtZVxuICAgICAgICBjb25zdCBuaWNrbmFtZSA9IHJlcGx5RGl2LnF1ZXJ5U2VsZWN0b3IoXCJbY2xhc3NePSd1c2VybmFtZS0nXVwiKT8udGV4dENvbnRlbnQ7XG4gICAgICAgIGlmKCFuaWNrbmFtZSl7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKHJlcGx5RGl2KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBDb3VsZE5vdFBhcnNlRXJyb3IoYEV4cGVjdGVkIGEgPHNwYW4gY2xhc3M9J3VzZXJuYW1lLSc+IGluIGRpdiwgYnV0IHF1ZXJ5U2VsZWN0b3IgY291bGRuJ3QgbG9jYXRlIG9uZWApO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5oZWFkZXIgPSB7bmlja25hbWU6IG5pY2tuYW1lfTtcblxuXG4gICAgICAgIC8vIFBhcnNlIGNvbnRleHRcbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRlbnREaXYgPSByZXBseURpdi5xdWVyeVNlbGVjdG9yKFwiW2lkXj0nbWVzc2FnZS1jb250ZW50J1wiKTtcbiAgICAgICAgaWYoIW1lc3NhZ2VDb250ZW50RGl2KXtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocmVwbHlEaXYpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IENvdWxkTm90UGFyc2VFcnJvcihgRXhwZWN0ZWN0ZWQgYSA8c3BhbiBpZD0nbWVzc2FnZS1jb250ZW50LS4uLic+IGluIGRpdiwgYnV0IHF1ZXJ5U2VsZWN0b3IgY291bGRuJ3QgbG9jYXRlIG9uZWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVnZXhNZXNzYWdlSWQgPSAvbWVzc2FnZS1jb250ZW50LShcXGR7MTl9KS8uZXhlYyhtZXNzYWdlQ29udGVudERpdi5pZCk7XG4gICAgICAgIGlmKHJlZ2V4TWVzc2FnZUlkICYmIHJlZ2V4TWVzc2FnZUlkLmxlbmd0aCA9PSAyKXtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IHttZXNzYWdlSWQ6IHJlZ2V4TWVzc2FnZUlkWzFdfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IocmVwbHlEaXYpO1xuICAgICAgICAgICAgdGhyb3cgbmV3IENvdWxkTm90UGFyc2VFcnJvcihgQ291bGQgbm90IGZpbmQgbWVzc2FnZUlkYCk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIC8vIFBhcnNlIGNvbnRlbnRcbiAgICAgICAgY29uc3QgbWVzc2FnZUNvbnRlbnRFbGVtcyA9IHJlcGx5RGl2LnF1ZXJ5U2VsZWN0b3IoXCJkaXZbaWRePSdtZXNzYWdlLWNvbnRlbnQnXVwiKT8uY2hpbGRyZW47XG5cbiAgICAgICAgaWYoIW1lc3NhZ2VDb250ZW50RWxlbXMpe1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihyZXBseURpdik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRW1wdHlNZXNzYWdlRXJyb3IoYE1lc3NhZ2UgY29udGFpbnMgbm8gdGV4dCBjb250ZW50YCk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbnRlbnQgPSB7IHRleHQ6IERpc2NvcmRNZXNzYWdlLnBhcnNlTWVzc2FnZVRleHQobWVzc2FnZUNvbnRlbnRFbGVtcykgfTtcbiAgICB9XG5cblxuICAgIHRvTWFya2Rvd24oKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGA+Kioke3RoaXMuaGVhZGVyLm5pY2tuYW1lfSoqOiAke3RoaXMuY29udGVudC50ZXh0fWA7XG4gICAgfVxufSIsICJpbXBvcnQgeyBDb3VsZE5vdFBhcnNlRXJyb3IsIEVtcHR5TWVzc2FnZUVycm9yLCBJRGlzY29yZE1lc3NhZ2UgfSBmcm9tIFwiLi90eXBlc1wiO1xuaW1wb3J0IERpc2NvcmRNZXNzYWdlUmVwbHkgZnJvbSBcIi4vRGlzY29yZE1lc3NhZ2VSZXBseVwiO1xuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIERpc2NvcmRNZXNzYWdlIGltcGxlbWVudHMgSURpc2NvcmRNZXNzYWdlIHtcbiAgICBjb250ZW50OiB7XG4gICAgICAgIHRleHQ/OiBzdHJpbmcsXG4gICAgICAgIGF0dGFjaG1lbnRzPzogc3RyaW5nW10gIC8vIGNvbnRhaW5zIFVSTCB0byBhdHRhY2htZW50XG4gICAgfVxuICAgIFxuICAgIGNvbnRleHQ6IHtcbiAgICAgICAgY2hhbm5lbElkOiBzdHJpbmdcbiAgICAgICAgbWVzc2FnZUlkPzogc3RyaW5nLCAgLy8gbWVzc2FnZWQgSUQgd2lsbCBiZSB1bmtub3duIHdoZW4gcGFzdGUgaGFwcGVucyB0byBiZSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW4gRGlzY29yZFNpbmdsZU1lc3NhZ2UgZm9ybWF0XG4gICAgfTtcblxuICAgIGhlYWRlcj86IHtcbiAgICAgICAgbmlja25hbWU6IHN0cmluZyxcbiAgICAgICAgdGltZUV4YWN0OiBudW1iZXIsICAvLyB1bml4IHRpbWVzdGFtcCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgdGltZVJlbGF0aXZlOiBzdHJpbmcsXG4gICAgICAgIGF2YXRhcj86IHN0cmluZywgIC8vIHVybFxuICAgICAgICByZXBseT86IERpc2NvcmRNZXNzYWdlUmVwbHlcbiAgICB9XG5cblxuICAgIGNvbnN0cnVjdG9yKE1FU1NBR0VfTEk6IEVsZW1lbnQpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgPGxpPiBlbXB0eSA9PiBlbXB0eSA8bGk+J3MgYXJlIGNvbW1vbiB3aGVuXG4gICAgICAgIC8vIGNvcHktcGFzdGluZyBEaXNjb3JkIG1lc3NhZ2VzIGFuZCBzaG91bGQgYmUgaWdub3JlZFxuICAgICAgICBpZighKE1FU1NBR0VfTEkuZmlyc3RFbGVtZW50Q2hpbGQ/LmlubmVySFRNTCkpe1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVtcHR5TWVzc2FnZUVycm9yKFwiPGxpPiBzZWVtcyB0byBiZSBlbXB0eVwiKVxuICAgICAgICB9XG5cblxuICAgICAgICAvLyBQYXJzZSB0aGUgaGVhZGVyLCBpZiBvbmUgZXhpc3RzXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLmNvbnN0cnVjdE1lc3NhZ2VIZWFkZXIoTUVTU0FHRV9MSSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBJZiBpbmNvbXBsZXRlIGhlYWRlciBpcyBwYXNzZWQsIGxpa2Ugb25lIG9ubHkgY29udGFpbmluZyBhIHRpbWVzdGFtcCwgY29udGludWUgd2l0aG91dCBidWlsZGluZyB0aGUgaGVhZGVyXG4gICAgICAgICAgICBpZighKGVycm9yIGluc3RhbmNlb2YgQ291bGROb3RQYXJzZUVycm9yKSl7XG4gICAgICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQYXJzZSB0aGUgbWVzc2FnZSBjb250ZXh0OyBndWFyYW50ZWVkIHRvIGV4aXN0XG4gICAgICAgIHRoaXMuY29uc3RydWN0TWVzc2FnZUNvbnRleHQoTUVTU0FHRV9MSSk7XG5cbiAgICAgICAgLy8gUGFyc2UgdGhlIG1lc3NhZ2UgY29udGVudDsgZ3VhcmFudGVlZCB0byBleGlzdFxuICAgICAgICB0aGlzLmNvbnN0cnVjdE1lc3NhZ2VDb250ZW50KE1FU1NBR0VfTEkpXG4gICAgfVxuXG5cbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0TWVzc2FnZUhlYWRlcihNRVNTQUdFX0xJOiBFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGhlYWRlckRpdiA9IE1FU1NBR0VfTEkucXVlcnlTZWxlY3RvcihcImgzW2NsYXNzXj0naGVhZGVyJ11cIik7XG4gICAgICAgIGlmKCFoZWFkZXJEaXYpe1xuICAgICAgICAgICAgdGhyb3cgbmV3IENvdWxkTm90UGFyc2VFcnJvcihgTm8gPGgzIGNsYXNzPSdoZWFkZXIuLi4nPiBmb3VuZGApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gLS0tIFBhcnNlIG5pY2tuYW1lLCBndWFyYW50ZWVkIHRvIGV4aXN0IGlmIGEgbWVzc2FnZSBoZWFkZXIgZXhpc3RzIC0tLVxuICAgICAgICBjb25zdCBuaWNrbmFtZSA9IGhlYWRlckRpdi5xdWVyeVNlbGVjdG9yKFwic3BhbltjbGFzc149J3VzZXJuYW1lJ11cIik/LnRleHRDb250ZW50O1xuICAgICAgICBpZighbmlja25hbWUpe1xuICAgICAgICAgICAgdGhyb3cgbmV3IENvdWxkTm90UGFyc2VFcnJvcihgTWVzc2FnZSBIZWFkZXIgZXhpc3RzLCBidXQgY291bGQgbm90IGZpbmQgbmlja25hbWVgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIFxuICAgICAgICAvLyAtLS0gUGFyc2UgdGltZSxoZWFkZXJEaXZ1YXJhbnRlZWQgdG8gZXhpc3QgaWYgYSBtZXNzYWdlIGhlYWRlciBleGlzdHMgLS0tY3QgdGltZXN0YW1waGVhZGVybGlcbiAgICAgICAgY29uc3QgdGltZUV4YWN0ID0gaGVhZGVyRGl2LnF1ZXJ5U2VsZWN0b3IoXCJ0aW1lXCIpPy5kYXRlVGltZVxuICAgICAgICBsZXQgdGltZVJlbGF0aXZlID0gaGVhZGVyRGl2LnF1ZXJ5U2VsZWN0b3IoXCJ0aW1lXCIpPy50ZXh0Q29udGVudDsgIC8vIEdldHMgd2hhdCdzIHByaW50ZWQgb24gdGhlIG1lc3NhZ2U7IGkuZS4gXCIgLS0gWWVzdGVyZGF5IGF0IDEyOjA4XCJcbiAgICAgICAgXG4gICAgICAgIGlmKCEodGltZUV4YWN0ICYmIHRpbWVSZWxhdGl2ZSkpe1xuICAgICAgICAgICAgdGhyb3cgbmV3IENvdWxkTm90UGFyc2VFcnJvcihgTWVzc2FnZSBIZWFkZXIgZXhpc3RzLCBidXQgY291bGQgbm90IGZpbmQgdGltZWApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gY3V0IG9mZiB0aGUgZmlyc3QgXCIgLS0gXCIgZnJvbSB0aW1lIHRleHQgXCIgLS0gVG9kYXkgYXQgMTg6NDNcIlxuICAgICAgICAgICAgY29uc3QgcmVnZXhUaW1lUmVsYXRpdmUgPSAvXHUyMDE0ICguKikvLmV4ZWModGltZVJlbGF0aXZlKTsgIFxuICAgICAgICAgICAgaWYoIShyZWdleFRpbWVSZWxhdGl2ZSAmJiByZWdleFRpbWVSZWxhdGl2ZS5sZW5ndGggPT0gMikpe1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBDb3VsZE5vdFBhcnNlRXJyb3IoXCJSZWxhdGl2ZSB0aW1lIGNvdWxkIG5vdCBiZSBwYXJzZWQgZnJvbSBSZWdleFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdGltZVJlbGF0aXZlID0gcmVnZXhUaW1lUmVsYXRpdmVbMV1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gLS0tIFBhcnNlIGF2YXRhciwgaWYgaXQgZXhpc3RzLiBBdmF0YXIgaXMgc3RvcmVkIGluIHNpc3RlciBvZiBoZWFkZXJEaXYgLS0tIFxuICAgICAgICBjb25zdCBhdmF0YXJEaXYgPSBNRVNTQUdFX0xJLnF1ZXJ5U2VsZWN0b3IoXCJpbWdbY2xhc3NePSdhdmF0YXInXVwiKSBhcyBIVE1MSW1hZ2VFbGVtZW50O1xuICAgICAgICBsZXQgYXZhdGFyVXJsID0gdW5kZWZpbmVkO1xuICAgICAgICBpZihhdmF0YXJEaXYpe1xuICAgICAgICAgICAgYXZhdGFyVXJsID0gYXZhdGFyRGl2LnNyYztcbiAgICAgICAgfVxuXG5cbiAgICAgICAgLy8gLS0tIFBhcnNlIE1lc3NhZ2VSZXBseSwgaWYgaXQgZXhpc3RzLiBSZXBseSBpcyBzdG9yZWQgaW4gc2lzdGVyIG9mIGhlYWRlckRpdiAtLS1cbiAgICAgICAgY29uc3QgbWVzc2FnZVJlcGx5RGl2ID0gTUVTU0FHRV9MSS5xdWVyeVNlbGVjdG9yKFwiZGl2W2lkXj0nbWVzc2FnZS1yZXBseSdcIik7XG4gICAgICAgIGxldCBtZXNzYWdlUmVwbHkgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmKG1lc3NhZ2VSZXBseURpdil7XG4gICAgICAgICAgICBtZXNzYWdlUmVwbHkgPSBuZXcgRGlzY29yZE1lc3NhZ2VSZXBseShtZXNzYWdlUmVwbHlEaXYpO1xuICAgICAgICB9XG4gICAgICAgIFxuXG4gICAgICAgIC8vIC0tLSBDb25zdHJ1Y3QgaGVhZGVyIC0tLVxuICAgICAgICBjb25zdCBoZWFkZXI6IERpc2NvcmRNZXNzYWdlW1wiaGVhZGVyXCJdID0ge1xuICAgICAgICAgICAgbmlja25hbWU6IG5pY2tuYW1lLFxuICAgICAgICAgICAgdGltZUV4YWN0OiBEYXRlLnBhcnNlKHRpbWVFeGFjdCksXG4gICAgICAgICAgICB0aW1lUmVsYXRpdmU6IHRpbWVSZWxhdGl2ZVxuICAgICAgICB9XG4gICAgICAgIGlmKGF2YXRhclVybCkgaGVhZGVyLmF2YXRhciA9IGF2YXRhclVybDtcbiAgICAgICAgaWYobWVzc2FnZVJlcGx5KSBoZWFkZXIucmVwbHkgPSBtZXNzYWdlUmVwbHk7XG5cbiAgICAgICAgdGhpcy5oZWFkZXIgPSBoZWFkZXI7XG4gICAgfVxuXG5cbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0TWVzc2FnZUNvbnRlbnQoTUVTU0FHRV9MSTogRWxlbWVudCkge1xuICAgICAgICBjb25zdCBtZXNzYWdlVGV4dEVsZW1zID0gdGhpcy5nZXRNZXNzYWdlVGV4dEVsZW1zKE1FU1NBR0VfTEkpOyAgLy8gRGlzY29yZFNpbmdsZU1lc3NhZ2UgZ2V0cyB0aGlzIGVsZW1lbnQgZGlmZmVyZW50bHlcbiAgICAgICAgY29uc3QgbWVzc2FnZUF0dGFjaG1lbnRFbGVtID0gTUVTU0FHRV9MSS5xdWVyeVNlbGVjdG9yKFwiZGl2W2lkXj0nbWVzc2FnZS1hY2Nlc3NvcmllcyddXCIpO1xuICAgICAgICBcbiAgICAgICAgaWYoIW1lc3NhZ2VUZXh0RWxlbXMgJiYgIW1lc3NhZ2VBdHRhY2htZW50RWxlbSl7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRW1wdHlNZXNzYWdlRXJyb3IoYE1lc3NhZ2UgY29udGFpbnMgbmVpdGhlciB0ZXh0IGNvbnRlbnQgbm9yIGF0dGFjaG1lbnRzYCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRoaXMuY29udGVudCA9IHt9XG4gICAgICAgIGlmKG1lc3NhZ2VUZXh0RWxlbXMpe1xuICAgICAgICAgICAgdGhpcy5jb250ZW50LnRleHQgPSBEaXNjb3JkTWVzc2FnZS5wYXJzZU1lc3NhZ2VUZXh0KG1lc3NhZ2VUZXh0RWxlbXMpO1xuICAgICAgICB9XG4gICAgICAgIGlmKG1lc3NhZ2VBdHRhY2htZW50RWxlbSl7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQuYXR0YWNobWVudHMgPSB0aGlzLnBhcnNlTWVzc2FnZUF0dGFjaG1lbnRzKG1lc3NhZ2VBdHRhY2htZW50RWxlbSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcHJvdGVjdGVkIGdldE1lc3NhZ2VUZXh0RWxlbXMoTUVTU0FHRV9MSTogRWxlbWVudCk6IEhUTUxDb2xsZWN0aW9uIHwgdW5kZWZpbmVkIHsgIFxuICAgICAgICAvLyBJZiB0aGUgbWVzc2FnZUxpIGNvbnRhaW5zIGEgcmVwbHkgdG8gYSBkaWZmZXJlbnQgbWVzc2FnZSwgdGhlIHRleHQgb2YgdGhlIHJlcGx5IHdpbGwgYmUgY2F1Z2h0IGZpcnN0IGJ5IFxuICAgICAgICAvLyBxdWVyeVNlbGVjdG9yIGlkXj0nbWVzc2FnZS1jb250ZW50JzsgaGVuY2Ugd2h5IHdlIGZpbHRlciBmb3IgYSBkaXYgaWQ9Xj0nbWVzc2FnZS1jb250ZW50JyB0aGF0IGlzIHRoZSBjaGlsZFxuICAgICAgICAvLyBvZiBhIGRpdiBjbGFzc149J2NvbnRlbnRzJyBcbiAgICAgICAgcmV0dXJuIE1FU1NBR0VfTEkucXVlcnlTZWxlY3RvcihcImRpdltjbGFzc149J2NvbnRlbnRzJ10gPiBkaXZbaWRePSdtZXNzYWdlLWNvbnRlbnQnXVwiKT8uY2hpbGRyZW47XG4gICAgfVxuXG4gICAgc3RhdGljIHBhcnNlTWVzc2FnZVRleHQobWVzc2FnZUNvbnRlbnRFbGVtczogSFRNTENvbGxlY3Rpb24pOiBzdHJpbmcgeyAgLy8gbmVlZHMgdG8gc3RheSBzdGF0aWMgdW50aWwgSSByZWZhY3RvciBEaXNjb3JkTWVzc2FnZVJlcGx5IHRvIGJlIGNoaWxkIG9mIERpc2NvcmRNZXNzYWdlXG4gICAgICAgIGNvbnN0IG1lc3NhZ2U6IHN0cmluZ1tdID0gW11cblxuICAgICAgICAvLyBVc2luZyBBcnJheS5mcm9tKCkgYmVjYXVzZSBlc2xpbnQgZG9lcyBub3QgcmVjb2duaXplIG1lIHVzaW5nIEVTMjAxNSsgZm9yIHNvbWUgcmVhc29uLi4uXG4gICAgICAgIGZvcihjb25zdCBlbGVtIG9mIEFycmF5LmZyb20obWVzc2FnZUNvbnRlbnRFbGVtcykpe1xuICAgICAgICAgICAgbGV0IHRleHRDb250ZW50ID0gZWxlbS50ZXh0Q29udGVudDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gLS0tIEVtb2ppcy9DdXN0b20gZW1vamlzIC0tLVxuICAgICAgICAgICAgaWYoIXRleHRDb250ZW50KXsgXG4gICAgICAgICAgICAgICAgaWYoL15lbW9qaUNvbnRhaW5lci8udGVzdChlbGVtLmNsYXNzTmFtZSkpe1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWdFbGVtID0gZWxlbS5jaGlsZHJlblswXSBhcyBIVE1MSW1hZ2VFbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICBpZighaW1nRWxlbSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiTm8gaW1nIGVsZW1lbnQgZm91bmQgaW4gc3Bhbi5lbW9qaUNvbnRhaW5lclwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmKC9eOi4rOiQvLnRlc3QoaW1nRWxlbS5hbHQpKXsgIC8vIElmIGl0J3MgYSBjdXN0b20gZW1vamksIHRoZW4gYWx0IHRleHQgaXMgJzplbW9qaU5hbWU6J1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5wdXNoKGA8aW1nIHNyYz0nJHtpbWdFbGVtLnNyY30nIHN0eWxlPSdoZWlnaHQ6IHZhcigtLWZvbnQtdGV4dC1zaXplKSc+YClcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsgIC8vIElmIGl0J3MgYSB1bmljb2RlIGVtb2ppLCB0aGVuIGFsdCB0ZXh0IGlzIHRoZSB1bmljb2RlIGVtb2ppXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnB1c2goYCR7aW1nRWxlbS5hbHR9YCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgLy8gLS0tIFRleHQgLS0tLVxuXG4gICAgICAgICAgICAvLyBJZiB0aGVyZSdzIGEgbmV3bGluZSwgc3RhcnQgdGhlIG5leHQgbGluZSBpbiBhIG5ldyBxdW90ZVxuICAgICAgICAgICAgdGV4dENvbnRlbnQgPSB0ZXh0Q29udGVudC5yZXBsYWNlKFwiXFxuXCIsIFwiXFxuPlwiKTtcblxuICAgICAgICAgICAgLy8gQ2hlY2sgdGhlIHRoZSB0eXBlIG9mIGEgbm9kZSB0byBkZXRlcm1pbmUgd2hhdCBraW5kIG9mIHRleHQgaXQgaXMuXG4gICAgICAgICAgICAvLyBGb3Igc29tZSB0eXBlcyBvZiB0ZXh0IChxdW90ZXMuLi4pIHdlIG5lZWQgdG8gY2hlY2sgdGhlXG4gICAgICAgICAgICAvLyBjbGFzcyBuYW1lIGluc3RlYWQuIEEgYmxvY2txdW90ZSB3aWxsIGhhdmUgY2xhc3M9XCJibG9ja3F1b3RlLTJBa2RESFwiLFxuICAgICAgICAgICAgLy8gd2hlcmVpbiB0aGUgbGFzdCA2IGFscGhhbnVtZXJpY2FscyB3aWxsIGJlIHJhbmRvbSBnaWJiZXJpc2guXG4gICAgICAgICAgICBzd2l0Y2goZWxlbS5ub2RlTmFtZSl7XG4gICAgICAgICAgICAgICAgY2FzZSBcIkVNXCI6IHsgLy8gaXRhbGljc1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnB1c2goYCoke3RleHRDb250ZW50fSpgKTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2FzZSBcIlNUUk9OR1wiOiB7IC8vIGJvbGRcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5wdXNoKGAqKiR7dGV4dENvbnRlbnR9KipgKTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2FzZSBcIlVcIjogeyAvLyB1bmRlcmxpbmVcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5wdXNoKGA8dT4ke3RleHRDb250ZW50fTwvdT5gKTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2FzZSBcIlNcIjogeyAgLy8gc3RyaWtldGhyb3VnaFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnB1c2goYH5+JHt0ZXh0Q29udGVudH1+fmApOyBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2FzZSBcIkgxXCI6IHsgIC8vIEhlYWRpbmcgMVxuICAgICAgICAgICAgICAgICAgICAvLyBoZWFkaW5ncyBkb24ndCBoYXZlIGEgbmV3bGluZSBieSBkZWZhdWx0LCBzbyB3ZSBhZGQgb25lIG1hbnVhbGx5XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UucHVzaChgKioke3RleHRDb250ZW50fSoqXFxuPmApOyBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2FzZSBcIkgyXCI6IHsgIC8vIEhlYWRpbmcgMlxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnB1c2goYCoqJHt0ZXh0Q29udGVudH0qKlxcbj5gKTsgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNhc2UgXCJIM1wiOiB7ICAvLyBIZWFkaW5nIDNcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZS5wdXNoKGAqKiR7dGV4dENvbnRlbnR9KipcXG4+YCk7IGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHsgIFxuICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBjbGFzcyBuYW1lcyBmb3Igb3RoZXIgZm9ybWF0dGluZyB0eXBlc1xuICAgICAgICAgICAgICAgICAgICAvLyBRdW90ZVxuICAgICAgICAgICAgICAgICAgICBpZigvXmJsb2NrcXVvdGUvLnRlc3QoZWxlbS5jbGFzc05hbWUpKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UucHVzaChgPiR7dGV4dENvbnRlbnR9YCk7IFxuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIChlZGl0ZWQpIG1hcmtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKC9edGltZXN0YW1wLy50ZXN0KGVsZW0uY2xhc3NOYW1lKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlLnB1c2goYCAqKGVkaXRlZCkqYClcblxuICAgICAgICAgICAgICAgICAgICAvLyBObyBzcGVjaWFsIHN0eWxpbmdcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UucHVzaCh0ZXh0Q29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbWVzc2FnZS5qb2luKFwiXCIpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBwYXJzZU1lc3NhZ2VBdHRhY2htZW50cyhtZXNzYWdlQWNjZXNzb3J5RWxlbTogRWxlbWVudCk6IHN0cmluZ1tdIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZUFjY2Vzc29yeUltYWdlcyA9IEFycmF5LmZyb20obWVzc2FnZUFjY2Vzc29yeUVsZW0ucXVlcnlTZWxlY3RvckFsbChcImltZ1wiKSkgYXMgSFRNTEltYWdlRWxlbWVudFtdO1xuXG4gICAgICAgIHJldHVybiBtZXNzYWdlQWNjZXNzb3J5SW1hZ2VzLm1hcCgoaW1nKSA9PiB7cmV0dXJuIGltZy5zcmN9KTtcbiAgICB9XG5cbiAgICBcbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0TWVzc2FnZUNvbnRleHQoTUVTU0FHRV9MSTogRWxlbWVudCkge1xuICAgICAgICAvLyBsaSBoYXMgYW4gaWQ9XCJjaGF0LW1lc3NhZ2VzLTU1NzMyNzE4ODMxMTkzMjk1OS0xMTM1MzI2NDc1MjQ0MDI3OTc1XCIsIHdpdGggZmlyc3QgbnVtYmVyXG4gICAgICAgIC8vIGJlaW5nIHRoZSBjaGFubmVsIElEIGFuZCBzZWNvbmQgbnVtYmVyIGJlaW5nIHRoZSBtZXNzYWdlIElEOyB0aGF0J3Mgd2hhdCB3ZSdyZSBleHRyYWN0aW5nLlxuICAgICAgICBjb25zdCBJZFJlZ2V4ID0gLyhcXGR7MTh9KS0oXFxkezE5fSkvLmV4ZWMoTUVTU0FHRV9MSS5pZCk7XG4gICAgICAgIFxuICAgICAgICBpZighKElkUmVnZXggJiYgSWRSZWdleC5sZW5ndGggPT0gMykpe1xuICAgICAgICAgICAgY29uc29sZS5sb2coTUVTU0FHRV9MSSk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgQ291bGROb3RQYXJzZUVycm9yKFwibWVzc2FnZUlkIGFuZCBzZXJ2ZXJJZCBub3QgZm91bmQgaW4gPGxpPiBpZFwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY29udGV4dCA9IHtcbiAgICAgICAgICAgIGNoYW5uZWxJZDogSWRSZWdleFsxXSxcbiAgICAgICAgICAgIG1lc3NhZ2VJZDogSWRSZWdleFsyXVxuICAgICAgICB9XG4gICAgfVxuXG5cbiAgICBwdWJsaWMgdG9NYXJrZG93bigpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBtYXJrZG93bkFycmF5OiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgICAgIC8vIE5pY2tuYW1lLCB0aW1lXG4gICAgICAgIGlmKHRoaXMuaGVhZGVyKXtcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0aGlzLmhlYWRlci50aW1lRXhhY3QpO1xuXG4gICAgICAgICAgICBtYXJrZG93bkFycmF5LnB1c2goXG4gICAgICAgICAgICAgICAgYCoqJHt0aGlzLmhlYWRlci5uaWNrbmFtZX0gLSAke2RhdGUudG9Mb2NhbGVTdHJpbmcoKX0qKmBcbiAgICAgICAgICAgIClcblxuICAgICAgICAgICAgaWYodGhpcy5oZWFkZXIucmVwbHkpe1xuICAgICAgICAgICAgICAgIG1hcmtkb3duQXJyYXkucHVzaCh0aGlzLmhlYWRlci5yZXBseS50b01hcmtkb3duKCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGV4dFxuICAgICAgICBpZih0aGlzLmNvbnRlbnQudGV4dCl7XG4gICAgICAgICAgICBtYXJrZG93bkFycmF5LnB1c2godGhpcy5jb250ZW50LnRleHQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQXR0YWNobWVudHNcbiAgICAgICAgaWYodGhpcy5jb250ZW50LmF0dGFjaG1lbnRzKXtcbiAgICAgICAgICAgIGZvcihjb25zdCB1cmwgb2YgdGhpcy5jb250ZW50LmF0dGFjaG1lbnRzKXtcbiAgICAgICAgICAgICAgICBtYXJrZG93bkFycmF5LnB1c2goYCFbXSgke3VybH0pYClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAnPicgKyBtYXJrZG93bkFycmF5LmpvaW4oXCJcXG4+XCIpO1xuICAgIH1cbn1cblxuIiwgImltcG9ydCBEaXNjb3JkTWVzc2FnZSBmcm9tIFwiLi9EaXNjb3JkTWVzc2FnZVwiO1xuaW1wb3J0IHsgQ291bGROb3RQYXJzZUVycm9yIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEaXNjb3JkU2luZ2xlTWVzc2FnZSBleHRlbmRzIERpc2NvcmRNZXNzYWdlIHtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlRGl2OiBFbGVtZW50KXtcbiAgICAgICAgc3VwZXIobWVzc2FnZURpdik7ICAgXG4gICAgfVxuICAgIFxuICAgIHByb3RlY3RlZCBnZXRNZXNzYWdlVGV4dEVsZW1zKG1lc3NhZ2VEaXY6IEVsZW1lbnQpOiBIVE1MQ29sbGVjdGlvbiB8IHVuZGVmaW5lZCB7XG4gICAgICAgIC8vIFRoaXMgdHlwZSBvZiBIVE1MIGNhbid0IGNvbnRhaW4gYSByZXBseSwgc28gaXRzIEhUTUwgc3RydWN0dXJlIGlzIG1vcmUgYmFzaWMuXG4gICAgICAgIC8vIFRoZSBtZXNzYWdlIGNvbnRlbnQgaXMgZXhwb3NlZCByaWdodCBhd2F5IGluIGEgZGlyZWN0IGNoaWxkIG9mIHRoZSBtZXNzYWdlIGRpdixcbiAgICAgICAgLy8gc28gd2UgbmVlZCB0byBjaGFuZ2UgdGhlIHF1ZXJ5U2VsZWN0b3JcbiAgICAgICAgLy8gSWYgdGhlIG1lc3NhZ2VMaSBjb250YWlucyBcbiAgICAgICAgcmV0dXJuIG1lc3NhZ2VEaXYucXVlcnlTZWxlY3RvcihcImRpdltpZF49J21lc3NhZ2UtY29udGVudCddXCIpPy5jaGlsZHJlbjtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY29uc3RydWN0TWVzc2FnZUNvbnRleHQobWVzc2FnZURpdjogRWxlbWVudCk6IHZvaWQge1xuICAgICAgICAvLyBUaGlzIHR5cGUgb2YgbWVzc2FnZXMgZG9lc24ndCBjb250YWluIGEgbWVzc2FnZSBJRFxuICAgICAgICBjb25zdCBtZXNzYWdlQ29udGVudEVsZW0gPSBtZXNzYWdlRGl2LnF1ZXJ5U2VsZWN0b3IoXCJkaXZbaWRePSdtZXNzYWdlLWNvbnRlbnQnXVwiKTtcbiAgICAgICAgY29uc3QgbWVzc2FnZUFjY2Vzc29yeUVsZW0gPSBtZXNzYWdlRGl2LnF1ZXJ5U2VsZWN0b3IoXCJkaXZbaWRePSdtZXNzYWdlLWFjY2Vzc29yaWVzJ11cIik7XG5cbiAgICAgICAgaWYoIW1lc3NhZ2VDb250ZW50RWxlbSAmJiAhbWVzc2FnZUFjY2Vzc29yeUVsZW0pe1xuICAgICAgICAgICAgdGhyb3cgbmV3IENvdWxkTm90UGFyc2VFcnJvcihcIk5vIGRpdiNtZXNzYWdlLWNvbnRlbnQgbm9yIGRpdiNtZXNzYWdlLWFjY2Vzc29yaWVzIGNvdWxkIGJlIGZvdW5kLlwiKVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2hhbm5lbElkUmVnZXggPSAvXFxkezE4fS87XG4gICAgICAgIGxldCByZWdleFJlc3VsdCA9IHVuZGVmaW5lZDtcbiAgICAgICAgaWYobWVzc2FnZUNvbnRlbnRFbGVtKXtcbiAgICAgICAgICAgIHJlZ2V4UmVzdWx0ID0gY2hhbm5lbElkUmVnZXguZXhlYyhtZXNzYWdlQ29udGVudEVsZW0uaWQpO1xuICAgICAgICB9IGVsc2UgaWYobWVzc2FnZUFjY2Vzc29yeUVsZW0pe1xuICAgICAgICAgICAgcmVnZXhSZXN1bHQgPSBjaGFubmVsSWRSZWdleC5leGVjKG1lc3NhZ2VBY2Nlc3NvcnlFbGVtLmlkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKCEocmVnZXhSZXN1bHQgJiYgcmVnZXhSZXN1bHQubGVuZ3RoID09IDEpKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBDb3VsZE5vdFBhcnNlRXJyb3IoXCJDb3VsZCBub3QgcGFyc2UgY2hhbm5lbCBpZCBmcm9tIG1lc3NhZ2UtY29udGVudCBkaXZcIik7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNvbnRleHQgPSB7XG4gICAgICAgICAgICBjaGFubmVsSWQ6IHJlZ2V4UmVzdWx0WzBdXG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCBEaXNjb3JkTWVzc2FnZSBmcm9tIFwiLi9EaXNjb3JkTWVzc2FnZVwiO1xuaW1wb3J0IERpc2NvcmRTaW5nbGVNZXNzYWdlIGZyb20gXCIuL0Rpc2NvcmRTaW5nbGVNZXNzYWdlXCI7XG5pbXBvcnQgeyBDb3VsZE5vdFBhcnNlRXJyb3IsIEVtcHR5TWVzc2FnZUVycm9yIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEaXNjb3JkQ29udmVyc2F0aW9uIHtcbiAgICBtZXNzYWdlczogRGlzY29yZE1lc3NhZ2VbXTtcblxuICAgIFxuICAgIGNvbnN0cnVjdG9yKERPTTogRG9jdW1lbnQpe1xuICAgICAgICBpZighdGhpcy5pc0Rpc2NvcmRQYXN0ZShET00pKXtcbiAgICAgICAgICAgIHRocm93IG5ldyBDb3VsZE5vdFBhcnNlRXJyb3IoXCJQYXN0ZSBkb2Vzbid0IGFwcGVhciB0byBiZSBmcm9tIERpc2NvcmRcIilcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSB0aGlzLmNyZWF0ZU1lc3NhZ2VzKERPTSk7XG4gICAgfVxuICAgIFxuXG4gICAgc3RhdGljIGZyb21SYXdIVE1MKEhUTUw6IHN0cmluZyl7XG4gICAgICAgIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcbiAgICAgICAgY29uc3QgRE9NOiBEb2N1bWVudCA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoSFRNTCwgJ3RleHQvaHRtbCcpO1xuICAgIFxuICAgICAgICByZXR1cm4gbmV3IHRoaXMoRE9NKTtcbiAgICB9XG5cblxuICAgIHByaXZhdGUgY3JlYXRlTWVzc2FnZXMoRE9NOiBEb2N1bWVudCk6IERpc2NvcmRNZXNzYWdlW10ge1xuICAgICAgICAvLyBGYWN0b3J5IGZvciBEaXNjb3JkIG1lc3NhZ2VzLCBhcyB0aGUgSFRNTCB3ZSBnZXQgY29tZXMgaW4gZGlmZmVyZW50IGZvcm1hdHM7IFxuICAgICAgICAvLyAxLikgQSBmb3JtYXQgd2l0aCBzb21lIDxvbCBjbGFzcz1cInNjcm9sbElubmVyXCI+PGxpPm1lc3NhZ2UuLi48L2xpPjxsaT5tZXNzYWdlLCwsPC9saT48L29sPlxuICAgICAgICAvLyAyLikgQSBmb3JtYXQsIHdoZW4gdGhlcmUncyBqdXN0IG9uZSBtZXNzYWdlLCB3aXRoIDxoMz51c2VybmFtZSwgdGltZSwgYXZhdGFyLi4uPC9oMz48ZGl2Pm1lc3NhZ2U8L2Rpdj5cbiAgICAgICAgLy8gRm9ybWF0ICMxIGNhbiBiZSBjb25zdHJ1Y3RlZCBieSB0aGUgRGlzY29yZE1lc3NhZ2UgY2xhc3MsIGZvcm1hdCAjMiBieSB0aGUgRGlzY29yZFNpbmdsZU1lc3NhZ2UgY2xhc3NcbiAgICAgICAgLy9cbiAgICAgICAgLy8gRG9uJ3Qga2lsbCBtZSBmb3IgdGhpcywgSSBvbmx5IG5vdGljZWQgdGhhdCB0aGUgc2Vjb25kIG9uZSBleGlzdHMgd2hlbiBJIHdhcyBhbHJlYWR5XG4gICAgICAgIC8vIDgwJSBkb25lIHdpdGggdGhpcyBwbHVnaW4uIEFuZCB0aGF0J3MgdGhlIGJhbmQtYWlkIHNvbHV0aW9uIEkgY2hvc2UgdG8gZ28gd2l0aC5cbiAgICAgICAgLy8gSWYgeW91J3ZlIGdvdCBzdWdnZXN0aW9ucyBmb3IgaG93IHRvIG1ha2UgdGhpcyBzdWNrIGxlc3MsIHBsZWFzZSBkbyBsZXQgbWUga25vdy4gXG5cbiAgICAgICAgY29uc3QgZGlzY29yZE1lc3NhZ2VzID0gW11cblxuICAgICAgICBjb25zdCBkb21PZk1lc3NhZ2VzOiBFbGVtZW50W10gPSBBcnJheS5mcm9tKERPTS5xdWVyeVNlbGVjdG9yQWxsKFwibGlcIikpO1xuICAgICAgICBpZihkb21PZk1lc3NhZ2VzLmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIGRvbU9mTWVzc2FnZXMpe1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGRpc2NvcmRNZXNzYWdlcy5wdXNoKG5ldyBEaXNjb3JkTWVzc2FnZShtZXNzYWdlKSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYoIShlcnIgaW5zdGFuY2VvZiBFbXB0eU1lc3NhZ2VFcnJvcikpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBFbXB0eSBsaSdzIGFyZSBleHBlY3RlZFxuICAgICAgICAgICAgICAgICAgICB9ICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkaXNjb3JkTWVzc2FnZXMucHVzaChuZXcgRGlzY29yZFNpbmdsZU1lc3NhZ2UoRE9NLmJvZHkpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkaXNjb3JkTWVzc2FnZXM7XG4gICAgfVxuXG5cbiAgICBwcml2YXRlIGlzRGlzY29yZFBhc3RlKERPTTogRG9jdW1lbnQpOiBib29sZWFuIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgaXQncyBhIHRleHQgbWVzc2FnZVxuICAgICAgICBjb25zdCBtZXNzYWdlQ29udGVudEVsZW0gPSBET00ucXVlcnlTZWxlY3RvcihcImRpdltpZF49J21lc3NhZ2UtY29udGVudCddXCIpO1xuICAgICAgICBpZihtZXNzYWdlQ29udGVudEVsZW0pe1xuICAgICAgICAgICAgLy8gZGl2IGlkIG11c3QgYWx3YXlzIGJlIGZvbGxvd2VkIGJ5IDE5LWRpZ2l0IG1lc3NhZ2UgaWRcbiAgICAgICAgICAgIGlmKCEoL21lc3NhZ2UtY29udGVudC1cXGR7MTl9Ly50ZXN0KG1lc3NhZ2VDb250ZW50RWxlbS5pZCkpKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiaXNEaXNjb3JkUGFzdGUgRkFJTDogTm8gPGRpdiBpZD0nbWVzc2FnZS1jb250ZW50LVxcXFxkezE5fSdcIilcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAvLyBjbGFzc05hbWUgbXVzdCBiZSBha2luIHRvIFwibWFya3VwLWVZTFByaSBtZXNzYWdlQ29udGVudC0ydDNlQ0lcIlxuICAgICAgICAgICAgaWYoISgvbWFya3VwLVtcXHdcXGRdezZ9Ly50ZXN0KG1lc3NhZ2VDb250ZW50RWxlbS5jbGFzc05hbWUpKSl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImlzRGlzY29yZFBhc3RlIEZBSUw6IE5vIDxkaXYgY2xhc3M9J21hcmt1cC1cXFxcd3s2fSdcIilcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZighKC9tZXNzYWdlQ29udGVudC1bXFx3XFxkXXs2fS8udGVzdChtZXNzYWdlQ29udGVudEVsZW0uY2xhc3NOYW1lKSkpe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJpc0Rpc2NvcmRQYXN0ZSBGQUlMOiBObyA8ZGl2IGNsYXNzPSdtZXNzYWdlQ29udGVudC1cXFxcd3s2fSdcIilcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIG5vdCBhIHRleHQgbWVzc2FnZSwgY2hlY2sgaWYgaXQncyBhIG1lZGlhIG1lc3NhZ2UgXG4gICAgICAgIGNvbnN0IG1lc3NhZ2VBY2Nlc29yaWVzRWxlbSA9IERPTS5xdWVyeVNlbGVjdG9yKFwiZGl2W2lkXj0nbWVzc2FnZS1hY2Nlc3NvcmllcyddXCIpO1xuICAgICAgICBpZihtZXNzYWdlQWNjZXNvcmllc0VsZW0pe1xuICAgICAgICAgICAgLy8gZGl2IGlkIG11c3QgYWx3YXlzIGJlIGZvbGxvd2VkIGJ5IDE5LWRpZ2l0IG1lc3NhZ2UgaWRcbiAgICAgICAgICAgIGlmKCEoL21lc3NhZ2UtYWNjZXNzb3JpZXMtXFxkezE5fS8udGVzdChtZXNzYWdlQWNjZXNvcmllc0VsZW0uaWQpKSl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihcImlzRGlzY29yZFBhc3RlIEZBSUw6IE5vIDxkaXYgaWQ9J21lc3NhZ2UtYWNjZXNzb3JpZXMtXFxcXGR7MTl9J1wiKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gY2xhc3NOYW1lIG11c3QgYWx3YXlzIGJlIGFraW4gdG8gXCJjb250YWluZXItMkVvZmNJXCJcbiAgICAgICAgICAgIGlmKCEoL2NvbnRhaW5lci1bXFx3XFxkXXs2fS8udGVzdChtZXNzYWdlQWNjZXNvcmllc0VsZW0uY2xhc3NOYW1lKSkpe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJpc0Rpc2NvcmRQYXN0ZSBGQUlMOiBObyA8ZGl2IGNsYXNzPSdjb250YWluZXItXFxcXHd7Nn0nXCIpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cblxuXG4gICAgcHVibGljIHRvTWFya2Rvd24oKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgbWFya2Rvd25BcnJheTogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICBmb3IoY29uc3QgbWVzc2FnZSBvZiB0aGlzLm1lc3NhZ2VzKXtcbiAgICAgICAgICAgIC8vIEluc2VydCBibGFuayBsaW5lIGJldHdlZW4gZGlmZmVyZW50IHVzZXJzXG4gICAgICAgICAgICBpZihtZXNzYWdlLmhlYWRlciAmJiBtYXJrZG93bkFycmF5Lmxlbmd0aCA+IDApe1xuICAgICAgICAgICAgICAgIG1hcmtkb3duQXJyYXkucHVzaChcIj5cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1hcmtkb3duQXJyYXkucHVzaChtZXNzYWdlLnRvTWFya2Rvd24oKSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbWFya2Rvd25BcnJheS5qb2luKFwiXFxuXCIpO1xuICAgIH1cbn0iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsc0JBQXFDOzs7QUNFOUIsSUFBTSxvQkFBTixjQUFnQyxNQUFNO0FBQUE7QUFBQTtBQUFBLEVBSXpDLFlBQVksU0FBa0I7QUFDMUIsVUFBTSxPQUFPO0FBRWIsV0FBTyxlQUFlLE1BQU0sa0JBQWtCLFNBQVM7QUFBQSxFQUMzRDtBQUNKO0FBR08sSUFBTSxxQkFBTixjQUFpQyxNQUFNO0FBQUE7QUFB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
